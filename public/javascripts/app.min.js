var app=angular.module("recipeCreator",["ngMaterial","ngRoute","angular-jwt"]);app.config(["$routeProvider","$locationProvider","$mdThemingProvider","$httpProvider","jwtInterceptorProvider",function(e,r,t,n,o){r.html5Mode(!0),o.tokenGetter=function(){return sessionStorage.getItem("userToken")},n.interceptors.push("jwtInterceptor"),t.theme("default").primaryPalette("amber").accentPalette("yellow"),e.when("/",{templateUrl:"/views/recipes.html",controller:"recipeMake"}).when("/dbsg_calc",{templateUrl:"/views/dbsgcalc.html",controller:"dbsgCalc"}).when("/login",{templateUrl:"/views/login.html",controller:"loginControl"}).when("/register",{templateUrl:"/views/register.html",controller:"registerControl"})}]),app.service("PpgCalc",function(){this.calcPpg=function(e){return 1e3*(1+e/100*.04621)/1e3}}),app.controller("recipeMake",["$scope","$http","jwtHelper",function(e,r,t){function n(t){r({method:"GET",url:"/"+t}).then(function(r){e[t]=r.data})}e.user={},e.user.recipetemplate="/views/notloggedin.html",n("grains"),n("hops"),n("yeasts"),e.recipe={name:"",grains:{totalWeight:function(){var r=0;return e.recipe.grains.added.forEach(function(e,t){e.grainWt>0&&(r+=parseInt(e.grainWt))}),r},totalPPG:function(){var r=0;return e.recipe.grains.added.forEach(function(t,n){r+=Math.round(1e3*(t.PPG-1)*t.grainWt/e.recipe.volume)/1e3}),r},efficiencyPPG:function(){var r=Math.round(e.recipe.grains.totalPPG()*(e.recipe.efficiency/100)*1e3)/1e3+1;return r>1.5&&(r=1.5),r.toString().length>5&&(r=r.toString().slice(0,5)),r},added:[]},efficiency:65,attenuation:70,volume:5,hops:{added:[],ibu:function(){if(e.recipe.hops.added.length>0&&e.recipe.grains.added.length>0){var r=0,t=0,n=1.65*Math.pow(125e-6,e.recipe.og()-1);return e.recipe.hops.added.forEach(function(o){if(t=o.hopWt*(o.Alpha_Acid/100)*7490/e.recipe.volume,"boil"==o.hopType){var i=(1-Math.pow(2.718281828459045,-.04*o.hopTime))/3.8,a=n*i;r+=a*t}else if("whirlpool"==o.hopType){var a=10;r+=a*t}}),Math.round(100*r)/100}return 0}},og:function(){return e.recipe.grains.added.length>0?e.recipe.grains.efficiencyPPG():0},fg:function(){if(e.recipe.grains.added.length>0){var r=Math.round(1e3*(e.recipe.grains.efficiencyPPG()-1)*(e.recipe.attenuation/100))/1e3;return r=e.recipe.og()-r,r.toString().length>5&&(r=r.toString().slice(0,5)),r}return 0},abv:function(){if(e.recipe.grains.added.length>0){var r=e.recipe.og(),t=e.recipe.fg();return Math.round(76.08*(r-t)/(1.775-r)*(t/.794)*100)/100}return 0},srm:function(){if(e.recipe.grains.added.length>0){var r=0,t=e.recipe.grains.added.forEach(function(e,t){r+=e.lovi*e.grainWt});return t=r/e.recipe.volume,t=Math.round(1.4922*Math.pow(t,.6859)*100)/100,t>50&&(t=50),t}return 0},dp:function(){if(e.recipe.grains.added.length>0){var r=0;return e.recipe.grains.added.forEach(function(e,t){r+=e.dp*e.grainWt}),Math.round(r/e.recipe.grains.totalWeight())}return 0},notes:""},e.saveRecipe=function(){var t={username:e.user.username,name:e.recipe.name,grains:{added:e.recipe.grains.added},efficiency:e.recipe.efficiency,volume:e.recipe.volume,attenuation:e.recipe.attenuation,hops:{added:e.recipe.hops.added},notes:e.notes};r({method:"post",url:"/private/recipes",data:t}).then(function(e){console.log(e.data)})},e.addIngredient=function(r,t){e.recipe[r].added.push(e[t]),e.grain={}},e.deleteItem=function(r,t){e.recipe[t].added.splice(r,1)},e.$watch(function(){return sessionStorage.getItem("userToken")},function(){if(sessionStorage.getItem("userToken")){var r=t.decodeToken(sessionStorage.getItem("userToken"));e.user=r,e.user.recipetemplate="/private/views/savedrecipes.html"}else e.user={},e.user.recipetemplate="/views/notloggedin.html"})}]),app.controller("dbsgCalc",["$scope",function(e){console.log("clicked"),console.log(e.dbfg+e.name)}]),app.controller("loginControl",["$rootScope","$scope","$http","$location",function(e,r,t,n){r.userLogin=function(){t({method:"post",data:r.user,url:"/loginauth"}).then(function(e){e.data.token&&sessionStorage.setItem("userToken",e.data.token),r.user={},n.url("/")})}}]),app.controller("registerControl",["$scope","$http","$location",function(e,r,t){e.registerUser=function(){r({method:"post",data:e.user,url:"/register"}).then(function(r){e.user=r.data,e.user.err||t.url("/login")})}}]),app.controller("headerControl",["$rootScope","$scope","jwtHelper",function(e,r,t){r.user={},r.$watch(function(){return sessionStorage.getItem("userToken")},function(){sessionStorage.getItem("userToken")?(r.user=t.decodeToken(sessionStorage.getItem("userToken")),r.user.login="Logout "+r.user.username,r.user.loginUrl="/"):(r.user={},r.user.login="Login/Register",r.user.loginUrl="/login")}),r.logOut=function(){sessionStorage.removeItem("userToken")}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIiRtZFRoZW1pbmdQcm92aWRlciIsIiRodHRwUHJvdmlkZXIiLCJqd3RJbnRlcmNlcHRvclByb3ZpZGVyIiwiaHRtbDVNb2RlIiwidG9rZW5HZXR0ZXIiLCJzZXNzaW9uU3RvcmFnZSIsImdldEl0ZW0iLCJpbnRlcmNlcHRvcnMiLCJwdXNoIiwidGhlbWUiLCJwcmltYXJ5UGFsZXR0ZSIsImFjY2VudFBhbGV0dGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwic2VydmljZSIsInRoaXMiLCJjYWxjUHBnIiwiZGJmZyIsIiRzY29wZSIsIiRodHRwIiwiand0SGVscGVyIiwiaXRlbSIsIm1ldGhvZCIsInVybCIsInRoZW4iLCJyZXMiLCJkYXRhIiwidXNlciIsInJlY2lwZXRlbXBsYXRlIiwicmVjaXBlIiwibmFtZSIsImdyYWlucyIsInRvdGFsV2VpZ2h0IiwidG90YWwiLCJhZGRlZCIsImZvckVhY2giLCJncmFpbiIsImluZGV4IiwiZ3JhaW5XdCIsInBhcnNlSW50IiwidG90YWxQUEciLCJNYXRoIiwicm91bmQiLCJQUEciLCJ2b2x1bWUiLCJlZmZpY2llbmN5UFBHIiwiZWZmUFBHIiwiZWZmaWNpZW5jeSIsInRvU3RyaW5nIiwibGVuZ3RoIiwic2xpY2UiLCJhdHRlbnVhdGlvbiIsImhvcHMiLCJpYnUiLCJhYXUiLCJiaWdGYWN0IiwicG93Iiwib2ciLCJob3AiLCJob3BXdCIsIkFscGhhX0FjaWQiLCJob3BUeXBlIiwiYm9pbFRGYWN0IiwiaG9wVGltZSIsInV0aWwiLCJmZyIsInllYXN0Rm9vZCIsImFidiIsInNybSIsInRvdGFsQ29sb3IiLCJtY3UiLCJsb3ZpIiwiZHAiLCJ0b3RhbGRwIiwibm90ZXMiLCJzYXZlUmVjaXBlIiwidXNlcm5hbWUiLCJjb25zb2xlIiwibG9nIiwiYWRkSW5ncmVkaWVudCIsImluZ3JlZGllbnQiLCJ0eXBlIiwiZGVsZXRlSXRlbSIsInNwbGljZSIsIiR3YXRjaCIsInVzZXJUb2tlbiIsImRlY29kZVRva2VuIiwiJHJvb3RTY29wZSIsIiRsb2NhdGlvbiIsInVzZXJMb2dpbiIsInRva2VuIiwic2V0SXRlbSIsInJlZ2lzdGVyVXNlciIsImVyciIsImxvZ2luIiwibG9naW5VcmwiLCJsb2dPdXQiLCJyZW1vdmVJdGVtIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxLQUFBQyxRQUFBQyxPQUFBLGlCQUFBLGFBQUEsVUFBQSxlQUVBRixLQUFBRyxRQUFBLGlCQUNBLG9CQUNBLHFCQUNBLGdCQUNBLHlCQUNBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FILEVBQUFJLFdBQUEsR0FFQUQsRUFBQUUsWUFBQSxXQUNBLE1BQUFDLGdCQUFBQyxRQUFBLGNBRUFMLEVBQUFNLGFBQUFDLEtBQUEsa0JBRUFSLEVBQUFTLE1BQUEsV0FDQUMsZUFBQSxTQUNBQyxjQUFBLFVBRUFiLEVBQUFjLEtBQUEsS0FDQUMsWUFBQSxzQkFDQUMsV0FBQSxlQUNBRixLQUFBLGNBQ0FDLFlBQUEsdUJBQ0FDLFdBQUEsYUFDQUYsS0FBQSxVQUNBQyxZQUFBLG9CQUNBQyxXQUFBLGlCQUNBRixLQUFBLGFBQ0FDLFlBQUEsdUJBQ0FDLFdBQUEsdUJBR0FwQixJQUFBcUIsUUFBQSxVQUFBLFdBQ0FDLEtBQUFDLFFBQUEsU0FBQUMsR0FDQSxNQUFBLE1BQUEsRUFBQUEsRUFBQSxJQUFBLFFBQUEsT0FJQXhCLElBQUFvQixXQUFBLGNBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUssRUFBQUMsRUFBQUMsR0F3S0EsUUFBQWYsR0FBQWdCLEdBQ0FGLEdBQ0FHLE9BQUEsTUFDQUMsSUFBQSxJQUFBRixJQUNBRyxLQUFBLFNBQUFDLEdBQ0FQLEVBQUFHLEdBQUFJLEVBQUFDLE9BNUtBUixFQUFBUyxRQUNBVCxFQUFBUyxLQUFBQyxlQUFBLDBCQUVBdkIsRUFBQSxVQUNBQSxF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UyxLQUFBaUQsU0FDQTFELEVBQUFTLEtBQUFvRSxTQUFBLE1BRUE3RSxFQUFBUyxRQUNBVCxFQUFBUyxLQUFBbUUsTUFBQSxpQkFDQTVFLEVBQUFTLEtBQUFvRSxTQUFBLFlBSUE3RSxFQUFBOEUsT0FBQSxXQUNBNUYsZUFBQTZGLFdBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdyZWNpcGVDcmVhdG9yJywgWyduZ01hdGVyaWFsJywgJ25nUm91dGUnLCAnYW5ndWxhci1qd3QnXSk7XG5cbiAgYXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxcbiAgICAgICAgICAgICAgJyRsb2NhdGlvblByb3ZpZGVyJyxcbiAgICAgICAgICAgICAgJyRtZFRoZW1pbmdQcm92aWRlcicsXG4gICAgICAgICAgICAgICckaHR0cFByb3ZpZGVyJyxcbiAgICAgICAgICAgICAgJ2p3dEludGVyY2VwdG9yUHJvdmlkZXInLFxuICAgICAgICAgICAgICBmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICRtZFRoZW1pbmdQcm92aWRlciwgJGh0dHBQcm92aWRlciwgand0SW50ZXJjZXB0b3JQcm92aWRlcil7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgand0SW50ZXJjZXB0b3JQcm92aWRlci50b2tlbkdldHRlciA9IGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlclRva2VuJyk7XG4gICAgfVxuICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2p3dEludGVyY2VwdG9yJyk7XG5cbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgLnByaW1hcnlQYWxldHRlKCdhbWJlcicpXG4gICAgICAuYWNjZW50UGFsZXR0ZSgneWVsbG93Jyk7XG5cbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJywge1xuICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcmVjaXBlcy5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdyZWNpcGVNYWtlJ1xuICAgIH0pLndoZW4oJy9kYnNnX2NhbGMnLCB7XG4gICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9kYnNnY2FsYy5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdkYnNnQ2FsYydcbiAgICB9KS53aGVuKCcvbG9naW4nLCB7XG4gICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9sb2dpbi5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkNvbnRyb2wnXG4gICAgfSkud2hlbignL3JlZ2lzdGVyJywge1xuICAgICAgdGVtcGxhdGVVcmw6Jy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdyZWdpc3RlckNvbnRyb2wnXG4gICAgfSk7XG4gIH1dKTtcbiAgYXBwLnNlcnZpY2UoJ1BwZ0NhbGMnLCBmdW5jdGlvbiAoKXtcbiAgICB0aGlzLmNhbGNQcGcgPSBmdW5jdGlvbihkYmZnKSB7XG4gICAgICByZXR1cm4gKDEwMDAgKiAoMSArIChkYmZnIC8gMTAwKSAqIDAuMDQ2MjEpKSAvIDEwMDBcbiAgICB9XG4gIH0pO1xuICAvL2NvbnRyb2xsZXIgZm9yIHRoZSByZWNpcGUgYnVpbGRlclxuICBhcHAuY29udHJvbGxlcigncmVjaXBlTWFrZScsIFsnJHNjb3BlJywgJyRodHRwJywgJ2p3dEhlbHBlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGp3dEhlbHBlcil7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcbiAgICAkc2NvcGUudXNlci5yZWNpcGV0ZW1wbGF0ZSA9ICcvdmlld3Mvbm90bG9nZ2VkaW4uaHRtbCc7XG4gICAgLy9nZXQgYWxsIGl0ZW1zIGxpc3RlZCBpbiB0aGUgc2VsZWN0IG1lbnVcbiAgICBnZXRJdGVtKCdncmFpbnMnKTtcbiAgICBnZXRJdGVtKCdob3BzJyk7XG4gICAgZ2V0SXRlbSgneWVhc3RzJyk7XG4gICAgLy9UaGUgb2JqZWN0IHVzZWQgZm9yIHJlY2lwZSBjcmVhdGlvbiBhcyB3ZWxsIGFzIGNhbGN1bGF0aW9uc1xuICAgICRzY29wZS5yZWNpcGUgPSB7XG4gICAgICBuYW1lOiAnJyxcbiAgICAgIGdyYWluczoge1xuICAgICAgICAvL3RoaXMgY2FsY3VsYXRlcyB0aGUgd2VpZ2h0IG9mIGFsbCBncmFpbnMgYWRkZWRcbiAgICAgICAgdG90YWxXZWlnaHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB0b3RhbCA9IDA7XG4gICAgICAgICAgJHNjb3BlLnJlY2lwZS5ncmFpbnMuYWRkZWQuZm9yRWFjaChmdW5jdGlvbihncmFpbiwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmKGdyYWluLmdyYWluV3QgPiAwKXtcbiAgICAgICAgICAgICAgdG90YWwgKz0gcGFyc2VJbnQoZ3JhaW4uZ3JhaW5XdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgICAgIH0sXG4gICAgICAgIC8vdGhpcyBjYWxjdWxhdGVzIHRoZSBtYXggc3VnYXIgZXh0cmFjdGlvbiBwb3NzaWJsZSBmcm9tIHRoZSBncmFpbnNcbiAgICAgICAgdG90YWxQUEc6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgdmFyIHRvdGFsID0gMDtcbiAgICAgICAgICAkc2NvcGUucmVjaXBlLmdyYWlucy5hZGRlZC5mb3JFYWNoKGZ1bmN0aW9uKGdyYWluLCBpbmRleCl7XG4gICAgICAgICAgICB0b3RhbCArPSAoTWF0aC5yb3VuZCgoZ3JhaW4uUFBHIC0gMSkgKiAxMDAwICogZ3JhaW4uZ3JhaW5XdCAvICRzY29wZS5yZWNpcGUudm9sdW1lKSkgLyAxMDAwO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgcmV0dXJuIHRvdGFsO1xuICAgICAgICB9LFxuICAgICAgICAvL3RoaXMgY2FsY3VsYXRlcyB0aGUgZXN0aW1hdGVkIHN1Z2FyIGV4dHJhY3Rpb24gYmFzZWQgb24gdXNlcidzIGVmZi4gaW5wdXRcbiAgICAgICAgZWZmaWNpZW5jeVBQRzogZnVuY3Rpb24oKXtcbiAgICAgICAgICB2YXIgZWZmUFBHID0gTWF0aC5yb3VuZCgkc2NvcGUucmVjaXBlLmdyYWlucy50b3RhbFBQRygpICogKCRzY29wZS5yZWNpcGUuZWZmaWNpZW5jeSAvIDEwMCkgKiAxMDAwKSAvIDEwMDAgKyAxO1xuICAgICAgICAgIGlmKGVmZlBQRyA+IDEuNSkge1xuICAgICAgICAgICAgZWZmUFBHID0gMS41O1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZihlZmZQUEcudG9TdHJpbmcoKS5sZW5ndGggPiA1KSB7XG4gICAgICAgICAgICBlZmZQUEcgPSBlZmZQUEcudG9TdHJpbmcoKS5zbGljZSgwLCA1KTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiBlZmZQUEc7XG4gICAgICAgIH0sXG4gICAgICAgIC8vbGlzdCBvZiBhbGwgZ3JhaW5zIGFkZGVkXG4gICAgICAgIGFkZGVkOiBbXVxuICAgICAgfSxcbiAgICAgIC8vZGVmYXVsdCBpbnB1dHMgZm9yIGVmZmljaWVuY3ksIGF0dGVudWF0aW9uLCBhbmQgdm9sdW1lXG4gICAgICBlZmZpY2llbmN5OiA2NSxcbiAgICAgIGF0dGVudWF0aW9uOiA3MCxcbiAgICAgIHZvbHVtZTogNSxcbiAgICAgIGhvcHM6IHtcbiAgICAgICAgLy9saXN0IG9mIGFsbCBob3BzIGFkZGVkXG4gICAgICAgIGFkZGVkOiBbXSxcbiAgICAgICAgLy9jYWxjdWxhdGVzIGlidSdzIGZvciB1c2VyJ3MgaW5wdXQgaG9wc1xuICAgICAgICBpYnU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmKCRzY29wZS5yZWNpcGUuaG9wcy5hZGRlZC5sZW5ndGggPiAwICYmICRzY29wZS5yZWNpcGUuZ3JhaW5zLmFkZGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBpYnUgPSAwO1xuICAgICAgICAgICAgdmFyIGFhdSA9IDA7XG4gICAgICAgICAgICB2YXIgYmlnRmFjdCA9IDEuNjUgKiBNYXRoLnBvdygwLjAwMDEyNSwgKCRzY29wZS5yZWNpcGUub2coKSAtIDEpKTtcbiAgICAgICAgICAgICRzY29wZS5yZWNpcGUuaG9wcy5hZGRlZC5mb3JFYWNoKGZ1bmN0aW9uKGhvcCkge1xuICAgICAgICAgICAgICBhYXUgPSBob3AuaG9wV3QgKiAoaG9wLkFscGhhX0FjaWQgLyAxMDApICogNzQ5MCAvICRzY29wZS5yZWNpcGUudm9sdW1lO1xuICAgICAgICAgICAgICBpZihob3AuaG9wVHlwZSA9PSAnYm9pbCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm9pbFRGYWN0ID0gKCgxIC0gTWF0aC5wb3coMi43MTgyODE4Mjg0NTkwNDUyMzUzNiwgKC0uMDQgKiBob3AuaG9wVGltZSkpKSAvIDMuOCk7XG4gICAgICAgICAgICAgICAgdmFyIHV0aWwgPSBiaWdGYWN0ICogYm9pbFRGYWN0O1xuICAgICAgICAgICAgICAgIGlidSArPSB1dGlsICogYWF1O1xuICAgICAgICAgICAgICB9IGVsc2UgaWYoaG9wLmhvcFR5cGUgPT0gJ3doaXJscG9vbCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXRpbCA9IDEwO1xuICAgICAgICAgICAgICAgIGlidSArPSB1dGlsICogYWF1XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoaWJ1ICogMTAwKSAvIDEwMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvL3RoaXMgaXMgdGhlIGZ1bmN0aW9uIHRvIHN0b3JlIHRoZSBPRyBvbiB0aGUgcGFnZVxuICAgICAgb2c6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZigkc2NvcGUucmVjaXBlLmdyYWlucy5hZGRlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuICRzY29wZS5yZWNpcGUuZ3JhaW5zLmVmZmljaWVuY3lQUEcoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vdGhpcyBjYWxjdWxhdGVzIHRoZSBmaW5hbCBncmF2aXR5IGJhc2VkIG9uIGF0dGVudWF0aW9uXG4gICAgICBmZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKCRzY29wZS5yZWNpcGUuZ3JhaW5zLmFkZGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2YXIgeWVhc3RGb29kID0gTWF0aC5yb3VuZCgoKCRzY29wZS5yZWNpcGUuZ3JhaW5zLmVmZmljaWVuY3lQUEcoKSAtIDEpICogMTAwMCkgKiAoJHNjb3BlLnJlY2lwZS5hdHRlbnVhdGlvbiAvIDEwMCkpIC8gMTAwMDtcbiAgICAgICAgICB5ZWFzdEZvb2QgPSAkc2NvcGUucmVjaXBlLm9nKCkgLSB5ZWFzdEZvb2Q7XG4gICAgICAgICAgaWYoeWVhc3RGb29kLnRvU3RyaW5nKCkubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgeWVhc3RGb29kID0geWVhc3RGb29kLnRvU3RyaW5nKCkuc2xpY2UoMCwgNSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB5ZWFzdEZvb2Q7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAwXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvL2FidiBjYWxjIGJhc2VkIG9uIGVzdGltYXRlZCBPRyBhbmQgRkdcbiAgICAgIGFidjogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKCRzY29wZS5yZWNpcGUuZ3JhaW5zLmFkZGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2YXIgb2cgPSAkc2NvcGUucmVjaXBlLm9nKCksXG4gICAgICAgICAgICAgIGZnID0gJHNjb3BlLnJlY2lwZS5mZygpO1xuICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKCg3Ni4wOCAqIChvZy1mZykgLyAoMS43NzUgLSBvZykpICogKGZnIC8gMC43OTQpICogMTAwKSAvIDEwMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gMFxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy9lc3RpbWF0ZSBjb2xvciBiYXNlZCBvbiBncmFpbnMgYWRkZWRcbiAgICAgIHNybTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKCRzY29wZS5yZWNpcGUuZ3JhaW5zLmFkZGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2YXIgdG90YWxDb2xvciA9IDA7XG4gICAgICAgICAgdmFyIG1jdSA9ICRzY29wZS5yZWNpcGUuZ3JhaW5zLmFkZGVkLmZvckVhY2goZnVuY3Rpb24oZ3JhaW4sIGluZGV4KSB7XG4gICAgICAgICAgICB0b3RhbENvbG9yICs9IChncmFpbi5sb3ZpICogZ3JhaW4uZ3JhaW5XdCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgbWN1ID0gdG90YWxDb2xvciAvICRzY29wZS5yZWNpcGUudm9sdW1lO1xuICAgICAgICAgIG1jdSA9IE1hdGgucm91bmQoKDEuNDkyMiAqIChNYXRoLnBvdyhtY3UsIDAuNjg1OSkpKSAqIDEwMCkgLyAxMDA7XG4gICAgICAgICAgaWYobWN1ID4gNTApe1xuICAgICAgICAgICAgbWN1ID0gNTA7XG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm4gbWN1O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy9lc3RpbWF0ZSBlbnp5bWF0aWMgYWN0aXZpdHkgYmFzZWQgb24gZ3JhaW5zIGFkZGVkXG4gICAgICBkcDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKCRzY29wZS5yZWNpcGUuZ3JhaW5zLmFkZGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB2YXIgdG90YWxkcCA9IDA7XG4gICAgICAgICAgJHNjb3BlLnJlY2lwZS5ncmFpbnMuYWRkZWQuZm9yRWFjaChmdW5jdGlvbihncmFpbiwgaW5kZXgpIHtcbiAgICAgICAgICAgIHRvdGFsZHAgKz0gZ3JhaW4uZHAgKiBncmFpbi5ncmFpbld0O1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHRvdGFsZHAgLyAkc2NvcGUucmVjaXBlLmdyYWlucy50b3RhbFdlaWdodCgpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG5vdGVzOiAnJ1xuICAgIH07XG5cbiAgICAkc2NvcGUuc2F2ZVJlY2lwZSA9IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcmVjaXBlID0ge1xuICAgICAgICB1c2VybmFtZTogJHNjb3BlLnVzZXIudXNlcm5hbWUsXG4gICAgICAgIG5hbWU6ICRzY29wZS5yZWNpcGUubmFtZSxcbiAgICAgICAgZ3JhaW5zOiB7XG4gICAgICAgICAgYWRkZWQ6ICRzY29wZS5yZWNpcGUuZ3JhaW5zLmFkZGVkXG4gICAgICAgIH0sXG4gICAgICAgIGVmZmljaWVuY3k6ICRzY29wZS5yZWNpcGUuZWZmaWNpZW5jeSxcbiAgICAgICAgdm9sdW1lOiAkc2NvcGUucmVjaXBlLnZvbHVtZSxcbiAgICAgICAgYXR0ZW51YXRpb246ICRzY29wZS5yZWNpcGUuYXR0ZW51YXRpb24sXG4gICAgICAgIGhvcHM6IHtcbiAgICAgICAgICBhZGRlZDogJHNjb3BlLnJlY2lwZS5ob3BzLmFkZGVkXG4gICAgICAgIH0sXG4gICAgICAgIG5vdGVzOiAkc2NvcGUubm90ZXNcbiAgICAgIH07XG4gICAgICAkaHR0cCh7XG4gICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICB1cmw6ICcvcHJpdmF0ZS9yZWNpcGVzJyxcbiAgICAgICAgZGF0YTogcmVjaXBlXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcyl7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTtcbiAgICAgIH0pXG4gICAgfVxuICAgIC8vZ2VuZXJpYyBmdW5jdGlvbiB0byBhZGQgYW4gaXRlbSB0byB0aGUgYXJyYXkgZm9yIHRob3NlIGluZ3JlZGllbnRzXG4gICAgJHNjb3BlLmFkZEluZ3JlZGllbnQgPSBmdW5jdGlvbihpbmdyZWRpZW50LCB0eXBlKXtcbiAgICAgICRzY29wZS5yZWNpcGVbaW5ncmVkaWVudF0uYWRkZWQucHVzaCgkc2NvcGVbdHlwZV0pO1xuICAgICAgJHNjb3BlLmdyYWluID0ge307XG4gICAgfVxuICAgIC8vcmVtb3ZlIGJ1dHRvbiBmdW5jdGlvbiAtIHJlbW92ZXMgb25lIGl0ZW0gZnJvbSB0aGUgYXJyYXlcbiAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uKGluZGV4LCB0eXBlKSB7XG4gICAgICAkc2NvcGUucmVjaXBlW3R5cGVdLmFkZGVkLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICAgIC8vZ2VuZXJpYyBmdW5jdGlvbiB0byBjYWxsIHRoZSBzZXJ2ZXIgZm9yIGEgc3BlY2lmaWMgaW5ncmVkaWVudFxuICAgIGZ1bmN0aW9uIGdldEl0ZW0oaXRlbSl7XG4gICAgICAkaHR0cCh7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIHVybDogJy8nICsgaXRlbVxuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlW2l0ZW1dID0gcmVzLmRhdGE7XG4gICAgICB9KVxuICAgIH07XG4gICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXJUb2tlbicpO1xuICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgIGlmKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXJUb2tlbicpKSB7XG4gICAgICAgICAgdmFyIHVzZXJUb2tlbiA9IGp3dEhlbHBlci5kZWNvZGVUb2tlbihzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VyVG9rZW4nKSk7XG4gICAgICAgICAgJHNjb3BlLnVzZXIgPSB1c2VyVG9rZW47XG4gICAgICAgICAgJHNjb3BlLnVzZXIucmVjaXBldGVtcGxhdGUgPSAnL3ByaXZhdGUvdmlld3Mvc2F2ZWRyZWNpcGVzLmh0bWwnXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkc2NvcGUudXNlciA9IHt9O1xuICAgICAgICAkc2NvcGUudXNlci5yZWNpcGV0ZW1wbGF0ZSA9ICcvdmlld3Mvbm90bG9nZ2VkaW4uaHRtbCdcbiAgICAgIH1cbiAgICB9KTtcbiAgfV0pO1xuXG5cbiAgLy9leHRyYSBmb3IgYSBjYWxjdWxhdG9yIGNvbnRyb2xsZXJcbiAgYXBwLmNvbnRyb2xsZXIoJ2Ric2dDYWxjJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xuICAgIGNvbnNvbGUubG9nKCdjbGlja2VkJyk7XG4gICAgY29uc29sZS5sb2coJHNjb3BlLmRiZmcgKyAkc2NvcGUubmFtZSk7XG4gICAgLy8gJHNjb3BlLmFkZGdyYWluID0gZnVuY3Rpb24oKXtcbiAgICAvLyAgIGlmKCEkc2NvcGUuZ3JhaW5zKSB7XG4gICAgLy8gICAgICRzY29wZS5ncmFpbnMgPSBbXTtcbiAgICAvLyAgIH1cbiAgICAvLyAgICRzY29wZS5ncmFpbnMucHVzaCgkc2NvcGUuZ3JhaW4pO1xuICAgIC8vICAgJHNjb3BlLmdyYWluID0ge307XG4gICAgLy8gfVxuICB9XSk7XG5cblxuICAvL2NvbnRyb2xsZXIgZm9yIGxvZ2luIHNjcmVlbiAtIHNlbmRzIHVzZXIvcGFzcyBhbmQgc3RvcmVzIGp3dFxuICBhcHAuY29udHJvbGxlcignbG9naW5Db250cm9sJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pe1xuICAgICRzY29wZS51c2VyTG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICRodHRwKHtcbiAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgIGRhdGE6ICRzY29wZS51c2VyLFxuICAgICAgICB1cmw6ICcvbG9naW5hdXRoJ1xuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpe1xuICAgICAgICBpZihyZXMuZGF0YS50b2tlbil7XG4gICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgndXNlclRva2VuJywgcmVzLmRhdGEudG9rZW4pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUudXNlciA9IHt9O1xuICAgICAgICAkbG9jYXRpb24udXJsKCcvJyk7XG4gICAgICB9KVxuICAgIH1cbiAgfV0pO1xuXG5cbiAgLy9jb250cm9sbGVyIGZvciByZWdpc3RlciBwYWdlIC0gc2VuZHMgbmV3IHVzZXIgaW5mbyBhbmQgcmV0dXJucyB0aGF0IGRhdGFcbiAgYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ29udHJvbCcsIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbil7XG4gICAgJHNjb3BlLnJlZ2lzdGVyVXNlciA9IGZ1bmN0aW9uKCl7XG4gICAgICAkaHR0cCh7XG4gICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICBkYXRhOiAkc2NvcGUudXNlcixcbiAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJ1xuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpe1xuICAgICAgICAkc2NvcGUudXNlciA9IHJlcy5kYXRhO1xuICAgICAgICBpZighJHNjb3BlLnVzZXIuZXJyKSB7XG4gICAgICAgICAgJGxvY2F0aW9uLnVybCgnL2xvZ2luJyk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XSk7XG4gIGFwcC5jb250cm9sbGVyKCdoZWFkZXJDb250cm9sJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICdqd3RIZWxwZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIGp3dEhlbHBlcil7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VyVG9rZW4nKTtcbiAgICB9LCBmdW5jdGlvbigpe1xuICAgICAgaWYoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlclRva2VuJykpe1xuICAgICAgICAkc2NvcGUudXNlciA9IGp3dEhlbHBlci5kZWNvZGVUb2tlbihzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VyVG9rZW4nKSk7XG4gICAgICAgICRzY29wZS51c2VyLmxvZ2luID0gJ0xvZ291dCAnICsgJHNjb3BlLnVzZXIudXNlcm5hbWU7XG4gICAgICAgICRzY29wZS51c2VyLmxvZ2luVXJsID0gJy8nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjb3BlLnVzZXIgPSB7fTtcbiAgICAgICAgJHNjb3BlLnVzZXIubG9naW4gPSAnTG9naW4vUmVnaXN0ZXInO1xuICAgICAgICAkc2NvcGUudXNlci5sb2dpblVybCA9ICcvbG9naW4nXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkc2NvcGUubG9nT3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyVG9rZW4nKTtcbiAgICB9XG4gIH1dKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==